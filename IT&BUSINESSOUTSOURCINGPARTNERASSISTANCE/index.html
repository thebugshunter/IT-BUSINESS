<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT & Aff√§rsassistans</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            color: #c9d1d9;
            overflow-x: hidden;
        }
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            width: 100%;
            height: 100%;
        }
        .text-gradient {
            background-image: linear-gradient(to right, #6EE7B7, #3B82F6, #9333EA);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .shimmer {
            position: relative;
            overflow: hidden;
        }
        .shimmer::after {
            content: '';
            position: absolute;
            top: 0;
            left: -60%;
            width: 60%; /* much wider highlight for a visible, elegant sheen */
            height: 100%;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.22) 50%, transparent 100%);
            filter: blur(4px);
            mix-blend-mode: overlay;
            pointer-events: none;
            opacity: 0;
            transform: translateX(0);
            transition: left 2200ms cubic-bezier(.2,.9,.25,1), transform 2200ms cubic-bezier(.2,.9,.25,1), opacity 500ms linear;
        }
        /* Left-to-right sweep: start off-left, activate to sweep across */
        .shimmer.sweep-ltr::after {
            left: -60%;
        }
        .shimmer.sweep-ltr.wave-active::after {
            left: 180%;
            opacity: 1;
        }
        /* Right-to-left sweep: position pseudo off-right, then animate to left */
        .shimmer.sweep-rtl::after {
            left: 180%;
        }
        .shimmer.sweep-rtl.wave-active::after {
            left: -60%;
            opacity: 1;
        }
        /* Shiny glow effect for cards */
        .card-bg.shimmer {
            background: linear-gradient(135deg, rgba(22, 27, 34, 0.8), rgba(110, 231, 183, 0.05));
            box-shadow: 0 0 20px rgba(110, 231, 183, 0.1), inset 0 0 20px rgba(110, 231, 183, 0.02);
            border: 1px solid rgba(110, 231, 183, 0.2);
            transition: all 0.3s ease;
        }
        .card-bg.shimmer:hover {
            box-shadow: 0 0 30px rgba(110, 231, 183, 0.2), inset 0 0 30px rgba(110, 231, 183, 0.05);
            border: 1px solid rgba(110, 231, 183, 0.4);
        }
        .card-bg {
            background-color: rgba(22, 27, 34, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid #30363d;
        }
        .btn-primary {
            transition: transform 0.2s, background-color 0.2s;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            background-color: #3b82f6;
        }
        .btn-blinking {
            animation: blinker 2s linear infinite;
        }
        @keyframes blinker {
            50% { opacity: 0.5; }
        }
        /* Fade-in animation for reveal effects */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .reveal {
            animation: fadeInUp 0.6s ease-out;
        }
        .hidden {
            display: none;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
        }
        #floating-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 50;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 9999px;
            display: none;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease-in-out;
        }
        #floating-button:hover {
            transform: scale(1.1);
        }
        #chat-window {
            position: fixed;
            bottom: 20px; /* Adjusted to give more space */
            right: 20px;
            width: 350px;
            max-width: 90%; /* To prevent overflow on very small screens */
            height: 500px;
            max-height: 80vh; /* Use viewport height for better scaling */
            background-color: rgba(22, 27, 34, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid #30363d;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: translateY(100%);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            z-index: 49;
        }
        #chat-window.open {
            transform: translateY(0);
            opacity: 1;
        }
        #chat-header {
            background-color: #161b22;
            padding: 1rem;
            border-bottom: 1px solid #30363d;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }
        #chat-messages {
            flex-grow: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .message-bubble {
            padding: 0.75rem 1rem;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
        }
        .user-message {
            background-color: #2a3a50;
            color: #e6f0ff;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        .bot-message {
            background-color: #1f2a3a;
            color: #d1e5ff;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        #chat-input-container {
            padding: 1rem;
            border-top: 1px solid #30363d;
            display: flex;
            flex-direction: row;
            align-items: flex-end; /* Align to the bottom of the container */
        }
        #chat-input {
            flex-grow: 1;
            padding: 0.75rem;
            background-color: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            color: #c9d1d9;
            resize: none;
            min-height: 40px; /* Ensure a minimum height */
        }
        #send-button {
            padding: 0.75rem 1rem;
            background-color: #3b82f6;
            color: white;
            border-radius: 8px;
            margin-left: 10px;
            display: flex; /* Ensure button content is centered */
            align-items: center;
            justify-content: center;
            height: 40px; /* Match height of input */
        }
        /* Navigation Bar Styles */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 40;
            background: rgba(13, 17, 23, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #30363d;
            padding: 1rem 2rem;
            transition: all 0.3s ease;
        }
        nav.scrolled {
            background: rgba(13, 17, 23, 0.5);
            border-bottom: 1px solid rgba(48, 54, 61, 0.3);
        }
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        .nav-logo {
            font-size: 1.25rem;
            font-weight: bold;
            color: #6EE7B7;
            text-decoration: none;
        }
        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        .nav-link {
            color: #c9d1d9;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.3s;
            cursor: pointer;
        }
        .nav-link:hover {
            color: #6EE7B7;
        }
        .lang-toggle {
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #6EE7B7, #3B82F6);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .lang-toggle:hover {
            transform: translateY(-2px);
        }
        .panic-btn-nav {
            padding: 0.5rem 1rem;
            background: #dc2626;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            animation: blinker 2s linear infinite;
            transition: background-color 0.2s;
        }
        .panic-btn-nav:hover {
            background-color: #b91c1c;
        }
        .help-btn-nav {
            padding: 0.5rem 1rem;
            background: rgba(59, 130, 246, 0.8);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .help-btn-nav:hover {
            background-color: #3b82f6;
        }
        /* Adjust main content for fixed nav */
        main {
            margin-top: 80px;
        }
        /* Mobile-specific styles for chat window */
        @media (max-width: 640px) {
            #chat-window {
                width: 90%;
                left: 50%;
                transform: translateX(-50%) translateY(100%);
                bottom: 20px;
                height: 80%;
            }
            #chat-window.open {
                transform: translateX(-50%) translateY(0);
            }
            nav {
                padding: 0.75rem 1rem;
            }
            /* Stack header nav vertically and center items for small screens */
            .nav-container {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }
            .nav-links {
                gap: 0.75rem;
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
            }
            .nav-link {
                font-size: 0.9rem;
            }
            .nav-logo {
                text-align: center;
                margin-bottom: 0.25rem;
            }
            .nav-links button, .nav-links .nav-link {
                padding: 0.45rem 0.75rem;
                font-size: 0.85rem;
            }

            /* On mobile, show buttons first then put Services/Projects on their own line below */
            .nav-links .help-btn-nav,
            .nav-links .panic-btn-nav,
            .nav-links .lang-toggle {
                order: 1;
                flex: 0 1 auto;
            }
            .nav-links .nav-link {
                order: 2;
                flex: 0 0 auto; /* allow links to sit side-by-side */
                display: inline-block;
                text-align: center;
                margin: 0 0.5rem;
            }

            /* Make header content appear after nav and centered */
            header {
                text-align: center;
                padding: 1rem 0.5rem;
            }
            header h1 {
                font-size: 2rem;
                line-height: 1.05;
            }

            /* Center membership card and make it compact */
            #membership-section {
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 1rem 0.5rem;
            }
            /* Make membership card wider on mobile (use more of the viewport) */
            #membership-section .card-bg {
                width: calc(100% - 32px);
                max-width: 98%;
                padding: 1.25rem 1rem;
                box-sizing: border-box;
            }
            /* When nav is compact, hide Services/Projects and show only buttons */
            nav.compact .nav-link { display: none !important; }
            nav.compact .help-btn-nav, nav.compact .panic-btn-nav, nav.compact .lang-toggle { display: inline-block; }
        }
        /* Detail modal styles */
        .detail-close {
            position: absolute;
            right: 12px;
            top: 10px;
            background: transparent;
            color: #c9d1d9;
            border: none;
            font-size: 1.4rem;
            cursor: pointer;
            line-height: 1;
        }
        #detail-modal .card-bg {
            max-width: 900px;
            width: calc(100% - 48px);
            max-height: 80vh;
            overflow: auto;
            padding: 1.25rem 1.5rem;
            border-radius: 12px;
        }
        #detail-title { color: #e6fff6; }
        #detail-body { color: #cbd6da; }
        #detail-footer {
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #30363d;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }
        @media (max-width: 640px) {
            #detail-footer {
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            #detail-footer p { display: none; }
            #detail-link { width: 100%; text-align: center; }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation Bar -->
    <nav>
        <div class="nav-container">
            <div class="nav-logo">IT & Business Outsourcing Partner</div>
            <div class="nav-links">
                <a class="nav-link" onclick="scrollToServices()" data-key="servicesNav">Services</a>
                <a class="nav-link" onclick="scrollToProjects()" data-key="projectsNav">Projects</a>
                <button class="help-btn-nav" onclick="toggleChat()" id="help-button-nav" data-key="helpButtonNav">üí¨ Help</button>
                <button class="panic-btn-nav" onclick="scrollToEmergency()" data-key="panicButtonNav">üö® Panic</button>
                <button class="lang-toggle" onclick="toggleLanguage()" id="lang-toggle-btn">
                    <span id="lang-display">EN/SV</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Three.js Canvas -->
    <canvas id="bg-canvas"></canvas>

    <!-- Main Content Wrapper -->
    <main class="relative z-10 min-h-screen flex flex-col justify-center items-center p-4 md:p-8">

        <!-- Header/Hero Section -->
        <header class="w-full max-w-5xl text-center my-16">
            <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-4 text-white shimmer">
                <span class="text-gradient" data-key="title">IT & Aff√§rsassistans</span>
            </h1>
            <p class="text-lg md:text-xl text-gray-400 max-w-3xl mx-auto mb-2" data-key="heroText">
                Din partner f√∂r digital spetskompetens. Med r√∂tter i Sverige hj√§lper vi f√∂retag och organisationer att blomstra i den digitala v√§rlden genom omfattande outsourcingl√∂sningar.
            </p>
            <!-- New Marketing Titles & Text -->
            <p class="text-base md:text-lg text-gray-400 max-w-3xl mx-auto mb-4" data-key="heroSubTitle1">
                Navigera i den digitala transformationen med oss.
            </p>
            <p class="text-base md:text-lg text-gray-400 max-w-3xl mx-auto mb-4" data-key="heroSubText1">
                Vi erbjuder skr√§ddarsydda strategier som effektiviserar er verksamhet och driver innovation fram√•t. V√•r expertis t√§cker allt fr√•n molnl√∂sningar till cybers√§kerhet, s√• att ni kan fokusera p√• det som √§r viktigt.
            </p>
            <p class="text-base md:text-lg text-gray-400 max-w-3xl mx-auto mb-4" data-key="heroSubTitle2">
                Maximera er potential med smarta l√∂sningar.
            </p>
            <p class="text-base md:text-lg text-gray-400 max-w-3xl mx-auto mb-8" data-key="heroSubText2">
                Genom att implementera de senaste teknologierna s√§kerst√§ller vi att ni alltid √§r ett steg f√∂re. Oavsett om det g√§ller avancerad dataanalys eller systemintegration, √§r vi h√§r f√∂r att hj√§lpa er n√• era m√•l.
            </p>
            <p class="text-base md:text-lg text-gray-400 max-w-3xl mx-auto mb-8" data-key="privateHelpText">
                Br√•kar skrivaren hemma och ingen kan hj√§lpa till?
            </p>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="panic-button" class="btn-primary btn-blinking bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-red-700 shimmer" onclick="scrollToEmergency()" data-key="panicButton">
                    Panikknapp
                </button>
                <button id="member-button-hero" class="btn-primary bg-gray-700 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-gray-600 shimmer" onclick="scrollToMembership()" data-key="memberButtonHero">
                    Bli Medlem
                </button>
            </div>
        </header>

        <!-- Services Section -->
        <section id="services" class="w-full max-w-6xl my-16">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-key="servicesTitle">Tj√§nster</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Service Card 1 -->
                <a href="#" target="_blank" data-detail="service1" role="button" class="card-bg shimmer rounded-2xl p-6 md:p-8 shadow-xl hover:shadow-2xl transition-shadow duration-300 block reveal" style="animation-delay: -0s">
                    <h3 class="text-xl font-bold mb-3 text-white flex items-center" data-key="service1Title">
                        Digital Transformation ‚ú®
                    </h3>
                    <p class="text-sm text-gray-400 leading-relaxed" data-key="service1Text">
                        Navigera i den digitala utvecklingens komplexitet. Vi √§r specialiserade p√• digital presentation, implementering och expansion, f√∂r att s√§kerst√§lla att ditt f√∂retag √§r redo f√∂r framtiden.
                    </p>
                </a>
                <!-- Service Card 2 -->
                <a href="#" target="_blank" data-detail="service2" role="button" class="card-bg shimmer rounded-2xl p-6 md:p-8 shadow-xl hover:shadow-2xl transition-shadow duration-300 block reveal" style="animation-delay: -1s">
                    <h3 class="text-xl font-bold mb-3 text-white flex items-center" data-key="service2Title">
                        Drift & Kontroll ‚öôÔ∏è
                    </h3>
                    <p class="text-sm text-gray-400 leading-relaxed" data-key="service2Text">
                        F√• full √∂verblick och kontroll. V√•r expertis t√§cker analys, kunskapshantering och utredning, vilket ger dig den datadrivna insikt du beh√∂ver f√∂r att lyckas.
                    </p>
                </a>
                <!-- Service Card 3 -->
                <a href="#" target="_blank" data-detail="service3" role="button" class="card-bg shimmer rounded-2xl p-6 md:p-8 shadow-xl hover:shadow-2xl transition-shadow duration-300 block reveal" style="animation-delay: -2s">
                    <h3 class="text-xl font-bold mb-3 text-white flex items-center" data-key="service3Title">
                        Validering & Support ‚úÖ
                    </h3>
                    <p class="text-sm text-gray-400 leading-relaxed" data-key="service3Text">
                        S√§kerst√§ll kvalitet och p√•litlighet. Vi erbjuder insikter fr√•n tredje part, verifiering, rigor√∂sa tester och kontinuerligt st√∂d f√∂r att h√•lla din verksamhet ig√•ng smidigt.
                    </p>
                </a>
            </div>
        </section>

        <!-- Projects Section: quick links to other index pages -->
        <section id="projects" class="w-full max-w-6xl my-16">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-8" data-key="projectsTitle">Projects & Pages</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                <a href="Nordic Shield/index.html" data-detail="nordicShield" class="block card-bg shimmer rounded-2xl p-6 hover:shadow-2xl transition-shadow duration-300 reveal" style="animation-delay: -0s">
                    <div class="flex items-center gap-4">
                        <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-blue-700 to-blue-400 flex items-center justify-center text-white font-bold text-lg">NS</div>
                        <div>
                            <h3 class="text-xl font-bold text-white" data-key="nordicShieldTitle">Nordic Shield</h3>
                            <p class="text-sm text-gray-400" data-key="nordicShieldDesc">Swedish tech vision and dashboard ‚Äì open to explore.</p>
                        </div>
                    </div>
                </a>

                <a href="Parental Guidance System /index.html" data-detail="parentalGuidance" class="block card-bg shimmer rounded-2xl p-6 hover:shadow-2xl transition-shadow duration-300 reveal" style="animation-delay: -1.5s">
                    <div class="flex items-center gap-4">
                        <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-green-600 to-yellow-400 flex items-center justify-center text-white font-bold text-lg">PG</div>
                        <div>
                            <h3 class="text-xl font-bold text-white" data-key="parentalGuidanceTitle">Parental Guidance System</h3>
                            <p class="text-sm text-gray-400" data-key="parentalGuidanceDesc">Parental and guidance project ‚Äì open for details.</p>
                        </div>
                    </div>
                </a>
            </div>
        </section>

        <!-- Emergency & Payment Section -->
        <section id="emergency" class="w-full max-w-4xl my-16 text-center">
            <div data-detail="emergency" role="button" class="card-bg rounded-2xl p-8 md:p-12 shadow-xl border-dashed border-2 border-red-500">
                <h2 class="text-3xl md:text-4xl font-bold text-red-400 mb-4" data-key="emergencyTitle">
                    Akut Support
                </h2>
                <p class="text-lg text-gray-300 mb-8" data-key="emergencyText">
                    F√∂r akuta situationer inom den privata sektorn erbjuder vi omedelbar assistans. Betala f√∂r eng√•ngsst√∂d eller teckna ett medlemskap f√∂r l√∂pande hj√§lp.
                </p>
                <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                    <button class="btn-primary btn-blinking bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-red-700 shimmer" onclick="showModal('Mock: Processing one-time payment with Stripe...'); event.stopPropagation();" data-key="emergencyButton">
                        Akut Support
                    </button>
                </div>
                <div class="mt-6 text-sm text-gray-400">
                    <p class="mb-2" data-key="klarnaText">
                        F√∂r fakturabetalning √§r vi integrerade med Klarna. Kontakta oss direkt f√∂r att ordna.
                    </p>
                    <p data-key="calendlyText">
                        Boka ett m√∂te med v√•rt team via <a href="#" id="calendly-link" class="text-blue-400 underline hover:text-blue-300">Calendly</a>.
                    </p>
                </div>
            </div>
        </section>

        <!-- Membership Section -->
        <section id="membership-section" class="w-full max-w-4xl my-16 text-center reveal">
            <div data-detail="membership" role="button" class="card-bg shimmer rounded-2xl p-8 md:p-12 shadow-2xl w-full mx-4 relative">
                <h2 class="text-3xl font-bold text-center text-white mb-6" data-key="membershipModalTitle">Medlemskap</h2>
                <p class="text-center text-gray-400 mb-8" data-key="membershipModalIntro">
                    V√•ra medlemskap erbjuder dig kontinuerlig support och kunskap, till ett l√§gre pris. Fyll i dina uppgifter f√∂r att se din personliga prisplan.
                </p>

                <!-- Membership Form -->
                <form id="membership-form" class="space-y-4">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-400" data-key="formNameLabel">Namn</label>
                        <input type="text" id="name" name="name" class="w-full px-4 py-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-700 focus:outline-none focus:ring focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-400" data-key="formEmailLabel">E-post</label>
                        <input type="email" id="email" name="email" class="w-full px-4 py-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-700 focus:outline-none focus:ring focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-400" data-key="formPhoneLabel">Mobilnummer</label>
                        <input type="tel" id="phone" name="phone" class="w-full px-4 py-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-700 focus:outline-none focus:ring focus:ring-blue-500" required>
                    </div>
                    <button type="submit" class="w-full btn-primary bg-blue-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-blue-700 shimmer" data-key="formSubmitButton">
                        Se Priser
                    </button>
                </form>

                <!-- Pricing Section (Hidden initially) -->
                <div id="pricing-results" class="mt-8 hidden">
                    <h3 class="text-2xl font-bold text-center text-white mb-4" data-key="pricingHeader">V√•ra Medlemskap</h3>
                    <p class="text-center text-gray-400 mb-6" data-key="pricingIntro">
                        J√§mf√∂r v√•ra medlemskap med eng√•ngssupport f√∂r att se hur mycket du kan spara.
                    </p>
                    <div class="space-y-4">
                        <!-- Pricing Card 1 -->
                        <div data-detail="plan1" class="card-bg p-6 rounded-lg border-blue-500 border-2 shimmer reveal" style="animation-delay: 0.1s">
                            <h4 class="text-xl font-bold mb-2 text-white" data-key="plan1Title">Bas Medlemskap</h4>
                            <p class="text-3xl font-bold text-green-400 mb-4" data-key="plan1Price">500 SEK/m√•nad</p>
                            <ul class="text-sm text-gray-400 list-disc list-inside space-y-1">
                                <li data-key="plan1Feature1">Grundl√§ggande IT-support</li>
                                <li data-key="plan1Feature2">Kontinuerlig information via e-post</li>
                                <li data-key="plan1Feature3">F√∂rtur till support</li>
                            </ul>
                        </div>
                        <!-- Pricing Card 2 -->
                        <div data-detail="plan2" class="card-bg p-6 rounded-lg shimmer reveal" style="animation-delay: 0.2s">
                            <h4 class="text-xl font-bold mb-2 text-white" data-key="plan2Title">Premium Medlemskap</h4>
                            <p class="text-3xl font-bold text-green-400 mb-4" data-key="plan2Price">900 SEK/m√•nad</p>
                            <ul class="text-sm text-gray-400 list-disc list-inside space-y-1">
                                <li data-key="plan2Feature1">Obegr√§nsad IT-support</li>
                                <li data-key="plan2Feature2">Personlig r√•dgivning</li>
                                <li data-key="plan2Feature3">Exklusivt utbildningsmaterial</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="w-full max-w-5xl text-center py-8 border-t border-gray-700 mt-16 text-sm text-gray-500">
            <p data-key="footerText1">
                Stolt baserade i Europa, med r√∂tter i Sverige.
            </p>
            <p class="mt-2" data-key="footerText2">
                &copy; 2026 IT & Aff√§rsassistans. Alla r√§ttigheter f√∂rbeh√•llna.
            </p>
        </footer>

    </main>

    <!-- Floating Chat Button -->
    <div id="floating-button" class="shimmer">
        <span class="text-white text-base font-bold" data-key="clickMeText">Help</span>
    </div>

    <!-- Chat Window -->
    <div id="chat-window" class="hidden">
        <div id="chat-header">
            <h3 class="font-bold" data-key="chatTitle">Chattassistent</h3>
            <button id="close-chat" class="text-white hover:text-gray-400">&times;</button>
        </div>
        <div id="chat-messages"></div>
        <div id="chat-input-container">
            <textarea id="chat-input" class="w-full" placeholder="Skriv ditt meddelande..." rows="1"></textarea>
            <button id="send-button" class="btn-primary" data-key="sendButton">Skicka</button>
        </div>
    </div>

    <!-- Message Modal -->
    <div id="message-modal" class="modal">
        <div class="card-bg rounded-lg p-6 w-11/12 max-w-sm">
            <p id="modal-text" class="text-center mb-4 text-white"></p>
            <button id="modal-close-button" class="btn-primary bg-blue-600 text-white w-full py-2 rounded-full">OK</button>
        </div>
    </div>

    <!-- Detail Modal for cards -->
    <div id="detail-modal" class="modal" aria-hidden="true">
        <div class="card-bg rounded-lg" style="max-width:900px; width:calc(100% - 48px); max-height:80vh; overflow:auto; padding:1.25rem 1.5rem; position:relative; display:flex; flex-direction:column;">
            <button id="detail-close-button" class="detail-close" aria-label="Close details">&times;</button>
            <h3 id="detail-title" class="text-2xl font-bold text-white mb-4"></h3>
            <div id="detail-body" class="text-gray-300 flex-1"></div>
            <div id="detail-footer" style="margin-top:1.5rem; padding-top:1rem; border-top:1px solid #30363d; display:flex; align-items:center; justify-content:space-between;">
                <p class="text-sm text-gray-500"></p>
                <a id="detail-link" href="#" class="btn-primary bg-blue-600 text-white px-6 py-2 rounded-full font-semibold hover:bg-blue-700" data-key="readMoreText"></a>
            </div>
        </div>
    </div>

    <script>
        // Language content mapping
        const content = {
            'sv': {
                title: 'IT & Aff√§rsassistans',
                heroText: 'Din partner f√∂r digital spetskompetens. Med r√∂tter i Sverige hj√§lper vi f√∂retag och organisationer att blomstra i den digitala v√§rlden genom omfattande outsourcingl√∂sningar.',
                heroSubTitle1: 'Navigera i den digitala transformationen med oss.',
                heroSubText1: 'Vi erbjuder skr√§ddarsydda strategier som effektiviserar er verksamhet och driver innovation fram√•t. V√•r expertis t√§cker allt fr√•n molnl√∂sningar till cybers√§kerhet, s√• att ni kan fokusera p√• det som √§r viktigt.',
                heroSubTitle2: 'Maximera er potential med smarta l√∂sningar.',
                heroSubText2: 'Genom att implementera de senaste teknologierna s√§kerst√§ller vi att ni alltid √§r ett steg f√∂re. Oavsett om det g√§ller avancerad dataanalys eller systemintegration, √§r vi h√§r f√∂r att hj√§lpa er n√• era m√•l.',
                privateHelpText: 'Br√•kar skrivaren hemma och ingen kan hj√§lpa till? Kontakta oss f√∂r akuta √§renden eller bli medlem f√∂r kontinuerlig uppdatering och v√§gledning inklusive support.',
                panicButton: 'Panikknapp',
                panicButtonNav: 'üö® Panik',
                servicesNav: 'Tj√§nster',
                projectsNav: 'Projekt',
                helpButtonNav: 'üí¨ Hj√§lp',
                memberButtonHero: 'Bli Medlem',
                contactButton: 'Kontakta Oss',
                servicesTitle: 'Tj√§nster',
                service1Title: 'Digital Transformation ‚ú®',
                service1Text: 'Navigera i den digitala utvecklingens komplexitet. Vi √§r specialiserade p√• digital presentation, implementering och expansion, f√∂r att s√§kerst√§lla att ditt f√∂retag √§r redo f√∂r framtiden.',
                service2Title: 'Drift & Kontroll ‚öôÔ∏è',
                service2Text: 'F√• full √∂verblick och kontroll. V√•r expertis t√§cker analys, kunskapshantering och utredning, vilket ger dig den datadrivna insikt du beh√∂ver f√∂r att lyckas.',
                service3Title: 'Validering & Support ‚úÖ',
                service3Text: 'S√§kerst√§ll kvalitet och p√•litlighet. Vi erbjuder insikter fr√•n tredje part, verifiering, rigor√∂sa tester och kontinuerligt st√∂d f√∂r att h√•lla din verksamhet ig√•ng smidigt.',
                emergencyTitle: 'Akut Support',
                emergencyText: 'F√∂r akuta situationer inom den privata sektorn erbjuder vi omedelbar assistans. Betala f√∂r eng√•ngsst√∂d eller teckna ett medlemskap f√∂r l√∂pande hj√§lp.',
                emergencyButton: 'Akut Support',
                memberButton: 'Bli Medlem',
                klarnaText: 'F√∂r fakturabetalning √§r vi integrerade med Klarna. Kontakta oss direkt f√∂r att ordna.',
                calendlyText: 'Boka ett m√∂te med v√•rt team via <a href="#" id="calendly-link" class="text-blue-400 underline hover:text-blue-300">Calendly</a>.',
                footerText1: 'Stolt baserade i Europa, med r√∂tter i Sverige.',
                footerText2: '¬© 2026 IT & Aff√§rsassistans. Alla r√§ttigheter f√∂rbeh√•llna.',
                membershipModalTitle: 'Medlemskap',
                membershipModalIntro: 'V√•ra medlemskap erbjuder kontinuerlig support och kunskap, till ett l√§gre pris. Fyll i dina uppgifter f√∂r att se din personliga prisplan.',
                formNameLabel: 'Namn',
                formEmailLabel: 'E-post',
                formPhoneLabel: 'Mobilnummer',
                formSubmitButton: 'Se Priser',
                pricingHeader: 'V√•ra Medlemskap',
                pricingIntro: 'J√§mf√∂r v√•ra medlemskap med eng√•ngssupport f√∂r att se hur mycket du kan spara.',
                plan1Title: 'Bas Medlemskap',
                plan1Price: '500 SEK/m√•nad',
                plan1Feature1: 'Grundl√§ggande IT-support',
                plan1Feature2: 'Kontinuerlig information via e-post',
                plan1Feature3: 'F√∂rtur till support',
                plan2Title: 'Premium Medlemskap',
                plan2Price: '900 SEK/m√•nad',
                plan2Feature1: 'Obegr√§nsad IT-support',
                plan2Feature2: 'Personlig r√•dgivning',
                plan2Feature3: 'Exklusivt utbildningsmaterial',
                projectsTitle: 'Projekt & Sidor',
                nordicShieldTitle: 'Nordic Shield',
                nordicShieldDesc: 'Svensk teknikvision och dashboard ‚Äì √∂ppna sidan f√∂r att utforska.',
                parentalGuidanceTitle: 'Parental Guidance System',
                parentalGuidanceDesc: 'F√∂r√§ldra- och v√§gledningsprojektet ‚Äî √∂ppna f√∂r detaljer.',
                clickMeText: 'Help',
                chatTitle: 'Chattassistent',
                sendButton: 'Skicka',
                modalCalendlyText: 'Omdirigerar till Calendlys bokningssida...',
                service1DetailTitle: 'Digital Transformation ‚Äî Detaljer',
                service1DetailText: '<p>Vi skapar strategier f√∂r digital n√§rvaro, molnmigrering, UX-design och API-integrationer. Typiska leverabler: roadmap, proof-of-concept och drifts√§ttning.</p>',
                service2DetailTitle: 'Drift & Kontroll ‚Äî Detaljer',
                service2DetailText: '<p>√ñvervakning, incidenthantering, kunskapshantering och driftspaket (SLA). Vi s√§tter upp dashboards, varningar samt rutiner f√∂r √•terst√§llning.</p>',
                service3DetailTitle: 'Validering & Support ‚Äî Detaljer',
                service3DetailText: '<p>QA, automatiserade tester, s√§kerhetsgranskning och l√∂pande support. Vi erbjuder testplaner, regressionstester och kontinuerlig verifiering.</p>',
                nordicShieldDetailTitle: 'Nordic Shield ‚Äî Detaljer',
                nordicShieldDetailText: '<p>Dashboardprojektet med datavisualisering, realtidsstatus och administrationsgr√§nssnitt f√∂r √∂vervakning.</p>',
                parentalGuidanceDetailTitle: 'Parental Guidance ‚Äî Detaljer',
                parentalGuidanceDetailText: '<p>Projektet fokuserar p√• f√∂r√§ldrahj√§lp, inst√§llningar f√∂r sk√§rmtid och rapportering av inneh√•ll f√∂r skolbruk.</p>',
                emergencyDetailTitle: 'Akut Support ‚Äî Detaljer',
                emergencyDetailText: '<p>Omedelbar assistans dygnet runt f√∂r privatpersoner med prioriterad kontakt, fels√∂kning p√• distans och m√∂jlighet till snabb hembes√∂k beroende p√• avtal.</p>',
                membershipDetailTitle: 'Medlemskap ‚Äî Detaljer',
                membershipDetailText: '<p>Medlemskap inkluderar prioriterad support, m√•nadsvisa h√§lsokontroller av system, och r√•dgivning. Olika niv√•er erbjuds beroende p√• behov.</p>',
                plan1DetailTitle: 'Bas Medlemskap ‚Äî Detaljer',
                plan1DetailText: '<p>Bas: grundl√§ggande support via e-post, m√•nadsvis statusrapport och f√∂rtur i k√∂.</p>',
                plan2DetailTitle: 'Premium Medlemskap ‚Äî Detaljer',
                plan2DetailText: '<p>Premium: obegr√§nsad support, snabbare SLA, personlig r√•dgivning och utbildningsmaterial.</p>',
                readMoreText: 'L√§s mer',
                openNewTabText: '√ñppnas i ny flik'
            },
            'en': { 
                title: 'IT & Business Assistance',
                heroText: 'Your partner for digital excellence. With roots in Sweden, we help companies and organizations thrive in the digital world through comprehensive outsourcing solutions.',
                heroSubTitle1: 'Navigate digital transformation with us.',
                heroSubText1: 'We offer tailored strategies that streamline your operations and drive innovation. Our expertise covers everything from cloud solutions to cybersecurity, so you can focus on what matters.',
                heroSubTitle2: 'Maximize your potential with smart solutions.',
                heroSubText2: 'By implementing the latest technologies, we ensure you are always one step ahead. Whether it\'s advanced data analysis or system integration, we are here to help you achieve your goals.',
                privateHelpText: 'Is your home printer giving you trouble and no one can help? Contact us for urgent matters or become a member for continuous updates and guidance including support.',
                panicButton: 'Panic Button',
                panicButtonNav: 'üö® Panic',
                servicesNav: 'Services',
                projectsNav: 'Projects',
                helpButtonNav: 'üí¨ Help',
                memberButtonHero: 'Become a Member',
                contactButton: 'Contact Us',
                servicesTitle: 'Services',
                service1Title: 'Digital Transformation ‚ú®',
                service1Text: 'Navigate the complexity of digital evolution. We specialize in digital presentation, implementation, and expansion, ensuring your business is ready for the future.',
                service2Title: 'Operations & Control ‚öôÔ∏è',
                service2Text: 'Gain full overview and control. Our expertise covers analysis, knowledge management, and investigation, giving you the data-driven insight you need to succeed.',
                service3Title: 'Validation & Support ‚úÖ',
                service3Text: 'Ensure quality and reliability. We offer third-party insights, verification, rigorous testing, and continuous support to keep your operations running smoothly.',
                emergencyTitle: 'Urgent Support',
                emergencyText: 'For urgent situations in the private sector, we offer immediate assistance. Pay for one-time support or sign up for a membership for ongoing help.',
                emergencyButton: 'Urgent Support',
                memberButton: 'Become a Member',
                klarnaText: 'For invoice payments, we are integrated with Klarna. Contact us directly to arrange.',
                calendlyText: 'Book a meeting with our team via <a href="#" id="calendly-link" class="text-blue-400 underline hover:text-blue-300">Calendly</a>.',
                footerText1: 'Proudly based in Europe, with roots in Sweden.',
                footerText2: '¬© 2026 IT & Business Assistance. All rights reserved.',
                membershipModalTitle: 'Membership',
                membershipModalIntro: 'Our memberships offer you continuous support and knowledge, at a lower price. Fill in your details to see your personal pricing plan.',
                formNameLabel: 'Name',
                formEmailLabel: 'Email',
                formPhoneLabel: 'Phone Number',
                formSubmitButton: 'See Pricing',
                pricingHeader: 'Our Memberships',
                pricingIntro: 'Compare our memberships with one-time support to see how much you can save.',
                plan1Title: 'Basic Membership',
                plan1Price: '500 SEK/month',
                plan1Feature1: 'Basic IT support',
                plan1Feature2: 'Continuous information via email',
                plan1Feature3: 'Priority access to support',
                plan2Title: 'Premium Membership',
                plan2Price: '900 SEK/month',
                plan2Feature1: 'Unlimited IT support',
                plan2Feature2: 'Personalized consultation',
                plan2Feature3: 'Exclusive training materials',
                projectsTitle: 'Projects & Pages',
                nordicShieldTitle: 'Nordic Shield',
                nordicShieldDesc: 'Swedish tech vision and dashboard ‚Äì open to explore.',
                parentalGuidanceTitle: 'Parental Guidance System',
                parentalGuidanceDesc: 'Parental and guidance project ‚Äì open for details.',
                clickMeText: 'Help',
                chatTitle: 'Chat Assistant',
                sendButton: 'Send',
                modalCalendlyText: 'Redirecting to Calendly booking page...',
                service1DetailTitle: 'Digital Transformation ‚Äî Details',
                service1DetailText: '<p>We craft digital roadmaps, cloud migration plans, UX improvements and API integrations. Deliverables typically include roadmaps, POCs and deployment.</p>',
                service2DetailTitle: 'Operations & Control ‚Äî Details',
                service2DetailText: '<p>Monitoring, incident response, knowledge management and operational SLAs. We build dashboards, alerts and recovery procedures.</p>',
                service3DetailTitle: 'Validation & Support ‚Äî Details',
                service3DetailText: '<p>QA, automated tests, security reviews, and ongoing support. We provide test plans, regression suites and continuous verification.</p>',
                nordicShieldDetailTitle: 'Nordic Shield ‚Äî Details',
                nordicShieldDetailText: '<p>Dashboard project with data visualizations, realtime status and admin interface for monitoring.</p>',
                parentalGuidanceDetailTitle: 'Parental Guidance ‚Äî Details',
                parentalGuidanceDetailText: '<p>Focuses on parental controls, screen-time settings and content reporting for educational scenarios.</p>',
                emergencyDetailTitle: 'Urgent Support ‚Äî Details',
                emergencyDetailText: '<p>Immediate assistance with priority contact, remote troubleshooting and onsite visits where applicable depending on the chosen plan.</p>',
                membershipDetailTitle: 'Membership ‚Äî Details',
                membershipDetailText: '<p>Memberships include priority support, monthly health checks and advisory time. Multiple tiers are available depending on needs.</p>',
                plan1DetailTitle: 'Basic Membership ‚Äî Details',
                plan1DetailText: '<p>Basic: email support, monthly status report and prioritized queue placement.</p>',
                plan2DetailTitle: 'Premium Membership ‚Äî Details',
                plan2DetailText: '<p>Premium: unlimited support, faster SLA, personalized consulting and training materials.</p>',
                readMoreText: 'Read More',
                openNewTabText: 'Opens in new tab'
            }
        };

        const setLanguage = (lang) => {
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.getAttribute('data-key');
                if (content[lang][key]) {
                    if (element.querySelector('a')) {
                         element.innerHTML = content[lang][key];
                    } else {
                        element.textContent = content[lang][key];
                    }
                }
            });
            document.title = content[lang].title;
            // Update language toggle button
            const langToggleBtn = document.getElementById('lang-toggle-btn');
            if (lang === 'sv') {
                langToggleBtn.textContent = 'EN/SV';
                localStorage.setItem('preferredLanguage', 'sv');
            } else {
                langToggleBtn.textContent = 'SV/EN';
                localStorage.setItem('preferredLanguage', 'en');
            }
        };

        let currentLanguage = 'en';
        
        const toggleLanguage = () => {
            currentLanguage = currentLanguage === 'en' ? 'sv' : 'en';
            setLanguage(currentLanguage);
        };

        // Modal functions
        const showModal = (message) => {
            const modal = document.getElementById('message-modal');
            const modalText = document.getElementById('modal-text');
            modalText.textContent = message;
            modal.style.display = 'flex';
        };

        const hideModal = () => {
            const modal = document.getElementById('message-modal');
            modal.style.display = 'none';
        };

        // Scroll functions
        const scrollToEmergency = () => {
            const emergencySection = document.getElementById('emergency');
            emergencySection.scrollIntoView({ behavior: 'smooth' });
        };

        const scrollToServices = () => {
            const servicesSection = document.getElementById('services');
            servicesSection.scrollIntoView({ behavior: 'smooth' });
        };

        const scrollToProjects = () => {
            const projectsSection = document.getElementById('projects');
            projectsSection.scrollIntoView({ behavior: 'smooth' });
        };

        const scrollToMembership = () => {
            const membershipSection = document.getElementById('membership-section');
            membershipSection.scrollIntoView({ behavior: 'smooth' });
        };
        
        const handleFormSubmit = (event) => {
            event.preventDefault();
            document.getElementById('membership-form').style.display = 'none';
            document.getElementById('pricing-results').classList.remove('hidden');
        };

        // Chatbot logic
        const chatWindow = document.getElementById('chat-window');
        const floatingButton = document.getElementById('floating-button');
        const closeChatButton = document.getElementById('close-chat');
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        let chatHistory = [];
        let isChatOpen = false;

        const toggleChat = () => {
            isChatOpen = !isChatOpen;
            chatWindow.classList.toggle('hidden', !isChatOpen);
            chatWindow.classList.toggle('open', isChatOpen);
        };

        const appendMessage = (sender, message) => {
            const messageBubble = document.createElement('div');
            messageBubble.classList.add('message-bubble');
            if (sender === 'user') {
                messageBubble.classList.add('user-message');
            } else {
                messageBubble.classList.add('bot-message');
            }
            messageBubble.textContent = message;
            chatMessages.appendChild(messageBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        };
        
        const sendMessage = async () => {
            const message = chatInput.value.trim();
            if (message === '') return;
            
            appendMessage('user', message);
            chatHistory.push({ role: "user", parts: [{ text: message }] });
            chatInput.value = '';
            
            appendMessage('bot', 'Skriver...'); // Loading message

            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: chatHistory,
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: "Du √§r en AI-assistent f√∂r IT & Aff√§rsassistans. Svara p√• fr√•gor kort och koncist. Beh√•ll ett professionellt, hj√§lpsamt och v√§nligt tonfall. H√•ll dig till IT-relaterade √§mnen. Svara p√• svenska." }]
                }
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const botMessage = result.candidates[0].content.parts[0].text;
                
                chatMessages.removeChild(chatMessages.lastChild); // Remove loading message
                appendMessage('bot', botMessage);
                chatHistory.push({ role: "model", parts: [{ text: botMessage }] });

            } catch (error) {
                console.error('API Error:', error);
                chatMessages.removeChild(chatMessages.lastChild);
                appendMessage('bot', 'Urs√§kta, jag kunde inte ansluta. F√∂rs√∂k igen senare.');
            }
        };

        // Event listeners
        document.getElementById('membership-form').addEventListener('submit', handleFormSubmit);
        document.getElementById('calendly-link').addEventListener('click', (event) => {
            event.preventDefault();
            showModal(content[currentLanguage].modalCalendlyText);
        });
        document.getElementById('modal-close-button').addEventListener('click', hideModal);

        floatingButton.addEventListener('click', toggleChat);
        closeChatButton.addEventListener('click', toggleChat);
        sendButton.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                sendMessage();
            }
        });

        // Scroll event for nav transparency
        window.addEventListener('scroll', () => {
            const nav = document.querySelector('nav');
            if (window.scrollY > 50) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }
        });

        // Mobile compact header: show only buttons when scrolling down, show full header when scrolling up
        (function mobileCompactHeader() {
            let lastY = window.scrollY;
            let ticking = false;
            function onScroll() {
                if (!ticking) {
                    window.requestAnimationFrame(() => {
                        const y = window.scrollY;
                        const nav = document.querySelector('nav');
                        const isMobile = window.innerWidth <= 640;
                        if (!isMobile) {
                            nav.classList.remove('compact');
                            lastY = y;
                            ticking = false;
                            return;
                        }

                        const delta = y - lastY;
                        // scrolling down -> compact (show buttons only)
                        if (delta > 8 && y > 40) {
                            nav.classList.add('compact');
                        }
                        // scrolling up -> expand
                        else if (delta < -8 || y < 40) {
                            nav.classList.remove('compact');
                        }

                        lastY = y;
                        ticking = false;
                    });
                    ticking = true;
                }
            }
            window.addEventListener('scroll', onScroll, { passive: true });
            window.addEventListener('resize', () => {
                const nav = document.querySelector('nav');
                if (window.innerWidth > 640) nav.classList.remove('compact');
            });
        })();
        
        // JS-driven shimmer wave: deterministic left‚Üíright then right‚Üíleft sequence
        function runShimmerWave() {
            const selector = '#services .shimmer, #projects .shimmer, #membership-section .shimmer';
            const nodes = Array.from(document.querySelectorAll(selector));
            if (!nodes.length) return;

            const stepDelay = 1600; // ms between each card activation (slower, professional pace)
            const hold = 2400; // ms each card remains highlighted
            let forward = true;

            (function loop() {
                const indices = forward ? nodes.map((_, i) => i) : nodes.map((_, i) => i).reverse();
                let t = 0;
                indices.forEach((idx) => {
                    setTimeout(() => {
                        const el = nodes[idx];
                        // apply directional class then activate in next frame for a clean CSS transition
                        if (forward) {
                            el.classList.add('sweep-ltr');
                        } else {
                            el.classList.add('sweep-rtl');
                        }
                        // trigger activation on next frame to ensure starting position applied
                        requestAnimationFrame(() => requestAnimationFrame(() => {
                            el.classList.add('wave-active');
                        }));

                        // remove classes after the sweep finishes
                        setTimeout(() => {
                            el.classList.remove('wave-active');
                            el.classList.remove('sweep-ltr');
                            el.classList.remove('sweep-rtl');
                        }, hold + 2250); // allow transition (2200ms) + hold
                    }, t);
                    t += stepDelay;
                });
                forward = !forward;
                // schedule next full pass after this one completes plus small gap
                setTimeout(loop, t + hold + 900);
            })();
        }
        
        // Detail modal handlers: open/close and data binding
        function openDetailModal(key) {
            const modal = document.getElementById('detail-modal');
            const titleEl = document.getElementById('detail-title');
            const bodyEl = document.getElementById('detail-body');
            const footer = document.getElementById('detail-footer');
            const link = document.getElementById('detail-link');
            if (!modal || !titleEl || !bodyEl) return;
            const lang = currentLanguage || 'en';
            const titleKey = key + 'DetailTitle';
            const bodyKey = key + 'DetailText';
            titleEl.textContent = (content[lang] && content[lang][titleKey]) ? content[lang][titleKey] : '';
            // allow HTML in body (for links/listing) but sanitize minimal by replacing script tags
            const raw = (content[lang] && content[lang][bodyKey]) ? content[lang][bodyKey] : '';
            bodyEl.innerHTML = raw.replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi, '');
            
            // Show footer with link only for project cards (nordicShield, parentalGuidance)
            const projectLinks = {
                'nordicShield': 'Nordic Shield/index.html',
                'parentalGuidance': 'Parental Guidance System /index.html'
            };
            
            if (projectLinks[key]) {
                footer.style.display = 'flex';
                link.href = projectLinks[key];
                link.textContent = (content[lang] && content[lang]['readMoreText']) ? content[lang]['readMoreText'] : 'Read More';
                // We navigate in the same tab ‚Äî no need to hint about a new tab
                footer.querySelector('p').textContent = '';
            } else {
                footer.style.display = 'none';
            }
            
            modal.style.display = 'flex';
            modal.setAttribute('aria-hidden','false');
        }

        function closeDetailModal() {
            const modal = document.getElementById('detail-modal');
            if (!modal) return;
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden','true');
        }

        function setupDetailHandlers() {
            // attach to any element with data-detail
            document.querySelectorAll('[data-detail]').forEach(el => {
                el.addEventListener('click', (e) => {
                    // prevent default navigation for anchors
                    if (el.tagName.toLowerCase() === 'a') e.preventDefault();
                    const key = el.getAttribute('data-detail');
                    if (!key) return;
                    openDetailModal(key);
                });
            });

            const closeBtn = document.getElementById('detail-close-button');
            if (closeBtn) closeBtn.addEventListener('click', closeDetailModal);

            // close when clicking overlay
            const detailModal = document.getElementById('detail-modal');
            if (detailModal) {
                detailModal.addEventListener('click', (ev) => {
                    if (ev.target === detailModal) closeDetailModal();
                });
            }

            // The detail link uses native anchor behavior (target="_blank")
            // so we avoid programmatic window.open which can be blocked by popup blockers.

            // ESC to close
            document.addEventListener('keydown', (ev) => { if (ev.key === 'Escape') closeDetailModal(); });
        }

        // Three.js setup for a futuristic, non-laggy background
        window.onload = function() {
            setLanguage('en'); // Set default language to English
            // start deterministic shimmer wave after DOM setup
            runShimmerWave();
            // wire up detail modal handlers
            setupDetailHandlers();

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg-canvas'), antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            const particles = [];
            const particleCount = 1000;
            const geometry = new THREE.SphereGeometry(0.1, 8, 8);
            const material = new THREE.MeshBasicMaterial({ color: 0x6EE7B7 });

            for (let i = 0; i < particleCount; i++) {
                const particle = new THREE.Mesh(geometry, material);
                particle.position.x = (Math.random() - 0.5) * 200;
                particle.position.y = (Math.random() - 0.5) * 200;
                particle.position.z = (Math.random() - 0.5) * 200;
                particles.push(particle);
                scene.add(particle);
            }

            camera.position.z = 5;

            // Animate function
            function animate() {
                requestAnimationFrame(animate);

                // Simple particle movement
                particles.forEach(p => {
                    p.rotation.x += 0.01;
                    p.rotation.y += 0.01;
                    p.position.z += 0.1;
                    if (p.position.z > camera.position.z + 10) {
                        p.position.z = camera.position.z - 200;
                    }
                });
                
                renderer.render(scene, camera);
            }
            animate();

            // Handle window resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        };
    </script>
</body>
</html>
